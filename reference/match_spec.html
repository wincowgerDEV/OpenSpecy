<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="match_spec() will compare a spectrum to a spectral library formatted
with the Open Specy standard and report the best match using the Pearson
correlation coefficient.
find_spec() makes it easy to retrieve single spectra and metadata
from the Open Specy reference library."><title>Match spectra with reference library — match_spec • OpenSpecy</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Match spectra with reference library — match_spec"><meta property="og:description" content="match_spec() will compare a spectrum to a spectral library formatted
with the Open Specy standard and report the best match using the Pearson
correlation coefficient.
find_spec() makes it easy to retrieve single spectra and metadata
from the Open Specy reference library."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">OpenSpecy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/sop.html">Standard Operating Procedure</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/wincowgerDEV/OpenSpecy-package/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Match spectra with reference library</h1>
      <small class="dont-index">Source: <a href="https://github.com/wincowgerDEV/OpenSpecy-package/blob/HEAD/R/match_spec.R" class="external-link"><code>R/match_spec.R</code></a></small>
      <div class="d-none name"><code>match_spec.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>match_spec()</code> will compare a spectrum to a spectral library formatted
with the Open Specy standard and report the best match using the Pearson
correlation coefficient.
<code>find_spec()</code> makes it easy to retrieve single spectra and metadata
from the Open Specy reference library.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">match_spec</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">match_spec</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for data.frame</span></span>
<span><span class="fu">match_spec</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">match_spec</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">library</span>,</span>
<span>  which <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"full"</span>,</span>
<span>  range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6000</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  top_n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">find_spec</span><span class="op">(</span></span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">library</span>,</span>
<span>  which <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"metadata"</span>,</span>
<span>  cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spectrum_identity"</span>, <span class="st">"organization"</span>, <span class="st">"contact_info"</span>, <span class="st">"spectrum_type"</span>,</span>
<span>    <span class="st">"instrument_used"</span>, <span class="st">"instrument_accessories"</span>, <span class="st">"instrument_mode"</span>, <span class="st">"laser_light_used"</span>,</span>
<span>    <span class="st">"total_acquisition_time_s"</span>, <span class="st">"number_of_accumulations"</span>,</span>
<span>    <span class="st">"level_of_confidence_in_identification"</span>, <span class="st">"cas_number"</span>, <span class="st">"material_producer"</span>,</span>
<span>    <span class="st">"material_purity"</span>, <span class="st">"material_form"</span>, <span class="st">"material_quality"</span>, <span class="st">"spectral_resolution"</span>,</span>
<span>    <span class="st">"data_processing_procedure"</span>, <span class="st">"other_information"</span>, <span class="st">"sample_name"</span>, <span class="st">"wavenumber"</span>,</span>
<span>    <span class="st">"intensity"</span>, <span class="st">"group"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector containing the spectral wavenumbers; alternatively
a data frame containing spectral data as <code>"wavenumber"</code> and
<code>"intensity"</code> can be supplied.</p></dd>


<dt>formula</dt>
<dd><p>an object of class '<code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>' of the form
<code>intensity ~ wavenumber</code>.</p></dd>


<dt>data</dt>
<dd><p>a data frame containing the variables in <code>formula</code>.</p></dd>


<dt>y</dt>
<dd><p>a numeric vector containing the spectral intensities.</p></dd>


<dt>library</dt>
<dd><p>reference library you want to compare against.</p></dd>


<dt>which</dt>
<dd><p>a character string specifying which library to match,
<code>"raman"</code> or <code>"ftir"</code>.</p></dd>


<dt>type</dt>
<dd><p>a character string specifying whether the <code>"full"</code> spectrum
should be matched or spectrum <code>"peaks"</code> only. <code>"metadata"</code> is
needed to browser spectra with <code>find_spec()</code>.</p></dd>


<dt>range</dt>
<dd><p>this should be all possible wavenumber values from your spectral
library.</p></dd>


<dt>top_n</dt>
<dd><p>number of top matches that you want to be returned.</p></dd>


<dt>subset</dt>
<dd><p>logical expression indicating elements or rows to search for;
see <code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a>()</code> for details.</p></dd>


<dt>cols</dt>
<dd><p>columns to retrieve from the Open Specy reference library;
columns containing no or missing values are automatically removed.</p></dd>


<dt>...</dt>
<dd><p>further arguments passed to the submethods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>match_spec()</code> returns a data frame with the <code>top_n</code> material
matches, their Pearson's r value, and the organization they were provided by.
<code>find_spec()</code> returns a data frame with the spectral raw data or
metadata of a specific reference spectrum.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This routine will match the spectrum you want to identify to the wavenumbers
present in the spectral library. Once the spectra are aligned, it computes
the Pearson correlation coefficient between the spectrum you want to
identify and all spectra in the library (see <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code>).
The function returns a table with the Pearson correlation coefficient values
and all metadata for the top spectral matches.
If using the Open Specy library, all intensity values are in absorbance, so
your spectra should also be in absorbance units. If you need to convert your
spectrum, use <code><a href="adj_intens.html">adj_intens</a>()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="adj_intens.html">adj_intens</a>()</code> converts spectra;
<code><a href="manage_lib.html">get_lib</a>()</code> retrieves the Open Specy reference library;
<code><a href="manage_lib.html">load_lib</a>()</code> loads the Open Specy reference library into an <span style="R">R</span>
object of choice</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Win Cowger, Zacharias Steinmetz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"raman_hdpe"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="manage_lib.html">get_lib</a></span><span class="op">(</span><span class="st">"raman"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spec_lib</span> <span class="op">&lt;-</span> <span class="fu"><a href="manage_lib.html">load_lib</a></span><span class="op">(</span><span class="st">"raman"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">match_spec</span><span class="op">(</span><span class="va">raman_proc</span>, library <span class="op">=</span> <span class="va">spec_lib</span>, which <span class="op">=</span> <span class="st">"raman"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">find_spec</span><span class="op">(</span><span class="va">sample_name</span> <span class="op">==</span> <span class="fl">5381</span>, library <span class="op">=</span> <span class="va">spec_lib</span>, which <span class="op">=</span> <span class="st">"raman"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Win Cowger, Zacharias Steinmetz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

